from pwn import *

HOST = "130.192.5.212"
PORT = 6532


data = b"A"*32
# print(len(data))

server = remote(HOST, PORT)

for i in range(128):
    print(server.recvline())

    server.sendlineafter(b": ", data.hex().encode())

    ct_hex = server.recvline().decode().strip().split()[-1]
    ct1 = bytes.fromhex(ct_hex)

    # print("First Round:")
    # print(f"{ct1[:16]} (len={len(ct1[:16])})\n{ct1[16:]} (len={len(ct1[16:])})")

    server.sendlineafter(b": ", data.hex().encode())
    ct_hex = server.recvline().decode().strip().split()[-1]
    ct2 = bytes.fromhex(ct_hex)

    # print("Second Round:")
    # print(f"{ct2[:16]} (len={len(ct2[:16])})\n{ct2[16:]} (len={len(ct2[16:])})")

    if ct1 == ct2:
        server.sendlineafter(b"(ECB, CBC)\n", b"ECB")
    else:
        server.sendlineafter(b"(ECB, CBC)\n", b"CBC")

    print(server.recvline())

print(server.recv(1024))

server.close()