from pwn import *
from Crypto.Util.Padding import pad
from Crypto.Util.number import long_to_bytes, bytes_to_long

HOST = "130.192.5.212"
PORT = 6552

server = remote(HOST, PORT)

#cookie = f"username={username}&admin=false"
# username=aaaaaaa
# truebbbbbbbbbbbb
# ccccccccc&admin=
email = b'a' * 7 + pad(b'true', 16) + b'c' * 9

server.sendlineafter(b"Username: ", email)

cookie_info = long_to_bytes(int(server.recvline().decode().strip()))

# print(cookie_info, len(cookie_info))

c1 = cookie_info[:16]
c2 = cookie_info[16:32]
c3 = cookie_info[32:48]

cookie_edt = str(bytes_to_long(c1 + c3 + c2))
# print(c1, c3, c2)
# print(cookie_edt)

server.sendlineafter(b"> ", b"flag")
server.sendlineafter(b"Cookie: ", cookie_edt.encode())

print(server.recv(1024))

server.close()