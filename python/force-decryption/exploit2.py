from pwn import *
from Crypto.Util.strxor import strxor

HOST = "130.192.5.212"
PORT = 6523

leak = b"mynamesuperadmin"
IV_fake = b"\x02" * 16
payload = strxor(leak, IV_fake).hex()

# Step 1: encrypt(payload)
server = remote(HOST, PORT)
server.sendlineafter(b"> ", b"enc")
server.sendlineafter(b"> ", payload.encode())



rand_iv = server.recvline_startswith(b"IV: ").strip().split()[-1]
ciphertext = server.recvline_startswith(b"Encrypted: ").strip().split()[-1]

# Step 2: decrypt(ciphertext, IV_fake)
server.sendlineafter(b"> ", b"dec")
server.sendlineafter(b"> ", ciphertext)
server.sendlineafter(b"> ", IV_fake.hex().encode())

# Should give the flag
print(server.recv(1024))
